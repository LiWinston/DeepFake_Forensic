# Forensic Tool for Detecting Deepfake and Synthetic Media

## Project Objective
To develop a forensic tool for detecting and analysing deepfake, digitally altered, and synthetic media (AI generated). The system will utilise image and video analysis algorithms, machine learning, and metadata analysis techniques to provide reliable, comprehensive, and automated forensic assistance for forensic investigators.

## Key Requirements
- Detection and analysis of deepfake, digitally altered and synthetic images and video  
- Detailed forensic analysis and reporting of anomalies in images and video sequences  
- User-friendly, intuitive interface for use by forensic investigators and analysts.  

## Media Analysis Algorithms & Techniques (Examples)

### Deep Learning Algorithms
1. **Convolutional Neural Networks (CNNs)**  
   - Extract visual features from frames and detect anomalies or inconsistencies  

2. **Generative Adversarial Networks (GAN) Detection**  
   - Identify media generated by GANs based on feature-level and residual artifacts  

3. **Autoencoders**  
   - Use reconstruction error to identify image/video regions inconsistent with learned normal patterns  

4. **3D CNNs / LRCNs**  
   - Analyse spatial-temporal inconsistencies in video (e.g. unnatural facial expressions or motion)  

5. **Transformers for Video**  
   - Capture long-term temporal dependencies and scene coherence across video frames.  

### Traditional Forensic Techniques
1. **Error Level Analysis (ELA)**  
   - Detect anomalies and inconsistencies in images and video  

2. **Noise Analysis**  
   - Analyse spatial noise distributions for irregularities.  

3. **Local Binary Patterns (LBP)**  
   - Extract texture features to highlight altered regions.  

4. **Copy-Move Forgery Detection**  
   - Identify duplicated regions in images or video frames.  

5. **Temporal Inconsistency Detection**  
   - Identify irregular blinking, facial jitter, or head pose changes in video.  

## Metadata Analysis Techniques
1. **Exif Data Analysis**  
   - Examine metadata from still images and videos for inconsistencies (e.g. device, GPS, timestamps, etc)  

2. **Container Metadata & Frame Hashing**  
   - Use tools to extract and verify structural integrity of video files e.g. FFmpeg.  

3. **Data Header Analysis**  
   - Examine the integrity and consistency of header information to detect tampering.  

4. **Hashing Techniques (MD5, SHA)**  
   - Verify file integrity and identify tampering.  

## Key Functionality
- **Media Upload and Input Handling**  
  - Support for JPEG, PNG, GIF, MP4, AVI etc  
  - Interface for image and video upload  

- **Preprocessing**  
  - Frame extraction (for video), resizing, normalisation, format validation  

- **Detection Modules**  
  - Integrate pre-trained CNN, GAN, and temporal models  
  - Confidence scoring and anomaly flagging  

- **Forensic Analysis Tools**  
  - Implement ELA, noise inconsistency, and LBP-based analysis  
  - Frame-by-frame forgery detection  

- **Metadata Inspection**  
  - Integrate ExifTool, FFmpeg, and hashing libraries.  
  - Display suspicious or altered metadata.  

- **Visualization and Reporting**  
  - Generate heatmaps, ELA overlays, and anomaly scores.  
  - Export findings as PDF/JSON reports.  

- **User Interface**  
  - Simple web UI built with Flask or React.js.  
  - View uploaded media, navigate frames, view analysis.  

- **Storage/Logging**  
  - Save metadata, logs, and forensic results using SQLite or PostgreSQL.  

## Intended Outcomes & Benefits
- A robust, forensically sound tool for investigating deepfake and synthetic media  
- Automated forensic support for visual content verification and analysis  
- Enhanced evidence integrity and chain-of-custody traceability.  
- Modular design to support future integration of audio analysis, multimodal AI created material  

---

# Requirement Change Log

## Week 4 Discussion Summary

### User & Stakeholder Profiles (Who/Do/Be/Feel)

| Who | Do | Be | Feel |
|---|---|---|---|
| **Students** | Model to separate AI images from real images | Software Application (Java/Python application) | Easy to use |
| **Lecturers** | Model to separate AI videos from real videos | Consistent (identify similar/same) reasons for same videos | - |
| **University of Melbourne** | Providing forensic insight (reason) for the separation | Reliable and accurately identifying the real and deepfake videos | - |
| **Tutors** | Take feedback from client based on varying success | Provide support for the student and the client | - |
| **Forensic Analyst (client)** | - | - | - |
| **Government** | - | - | - |

### Key Client Requirements & Insights

- **Core Task:** The client wants to know if a video/image is real, edited, or AI-generated
- **Interpretability:** Interpretability is crucial for forensic analysts
    - For images, use heatmaps to show exactly which parts are AI-generated
    - For videos, identify which specific frames are AI-generated
- **Reporting:** A potential solution is to use a large language model (like ChatGPT API) to generate a formal forensic report based on algorithmic and metadata analysis results. This would make the client's life easier and produce a report suitable for court
- **Edited Media:** Training data exists for real vs. AI-generated media, but how to tell if something is merely edited?
    - **Proposed Solution:** Use algorithmic approaches to detect edited content

### System Architecture & Implementation Notes

- **Models:** Potentially implement an image detection CNN and apply it to video frame-by-frame analysis
- **Model Training:** It's preferable to use pre-trained models and fine-tune them for performance rather than building new models from scratch
- **Backend Infrastructure:**
    - An ideal scenario includes a user login system
    - Users can create projects and submit multiple images/videos
    - Projects will be stored in the backend until the user deletes them
    - Different users should only have access to their own projects and not be able to cross-access others' data
    - Users should be able to view all their project history, reports, and documents
- **Project Limitations:** No limits to the number or type of projects, only limited by technological constraints, such as not being able to process a 10-hour video

### Ethical Considerations

- **Data Usage:** Do not use inappropriate data for training, such as pornographic material, anything involving children, or violence

### Future Research & Exploration

- **Multimodal Analysis:** Explore building a multimodal transformer that can take inputs like audio, images, and metadata to analyze if content is edited, AI-generated, or real
- **Video Transformer:** Research the use of a video transformer for analysis


## Week 7 Client Meeting Notes (Thrusday 11/Sep)

### For the UI:
- the real impletation of the analysis page
- No need to use Email, but how to reset the password without email (let us to discuss). However client want it to be totally local without outer system.
Re: Currently not dependent on email, pw reset is based on validating original and setting a new one.

### For the analysis page:
- He want some button to export the result as pdf/csv/docx for the appoprate format.
- For the page of setting the project, the date he want it to be (day/month/year) not (year/month/day)
- It is better to have a progress bar, when backend algorithms etc is running. As for the latter application like the video one would cost a long time, without progress bar would be confused.
- Also some method to make the result more smmoth like: Based on the analysis of the ** frames, lt is likely to have risk etc.(Very later work)

### For the Backend:

#### General:
- All the result should give independently no need to calcultate the whole score.
- For each Traditional tool/ AI tool , he want it to have the selection bar of the models for each one. Not just running all the algorithms the same time.

#### For meta data analysis:
- Some misunderstanding of the file header What are File Headers? (Signatures) - eDiscovery Software | eDiscovery Collection Software | Pinpoint Labs
- There is an area called file header anaysis, want us to finish with that. (it is the Data header analysis in the pdf)
- For file header & Container Metadata & Frame Hashing (Use tools to extract and verify structural integrity of video files e.g. FFmpeg.) (Still not finished):
  - There can be a sentences to detect if there are anomonilies or not. Rather than just give the information.

#### For traditional Method:
- Some confusion(Maybe it is not calculated righ) about the cofidence score for Copy Move & lighting.
- Moreover there are another methods left to implement.
- But no need to calculate the ovrall score. He want it to be seperate scores for each individuals.
- Also He wants to have the option to choose for which techniques he want to use.

#### For NN:
- No need to train the model ourselves. Very convenient to just use the exist One (CNN). And simply give the answer.
- Also He wants to have the option to choose for which techniques he want to use.

### Future:
- It is definetly better to have the function to detect for Audio ones. And it is very similar to the video.

### ref:
- eDiscovery Software | eDiscovery Collection Software | Pinpoint Labs
- https://pinpointlabs.com/what-are-file-headers-signatures/
- Many file types can be identified by using what’s known as afile header. A file header is a ‘signature’ placed at the beginning of a file, so the operating system and other software know what to do with the following contents.

---

# Latest Requirements Update - September 2025

## Updated User & Stakeholder Profiles (Who/Do/Be/Feel)

| Who | Do | Be | Feel |
|---|---|---|---|
| **Users** | Upload images/videos | High in quality, yet small in size | Confident (security, easy to use) |
| **Users** | Log in securely | Quick and secure | Protected |
| **Forensic Analysts / Model** | Extract metadata from uploaded media | Efficient and relatively quick | Dependable |
| **Model** | Analyse metadata from uploaded media | Efficient and fast | Automatic |
| **System** | Input uploaded media into our ML model (be it CNN etc.) | Scalable (situation where multiple people use our system) and relatively accurate | That it is accurate |
| **System** | Generate Grad CAM heatmap of edited/generated media | Clear and detailed | More informable |
| **Admin** | Low confidence classification (active learning) ? maybe | Good input to further train our model | Empowering |
| **Users** | See history of media classified by our system | Storage efficient, yet detailed and useful | Secure (history is important) |

## User Stories

- As a user, I want to log into a system in a secure manner using email and password.
- As a user, I want to be able to view my history of uploads linked to my account.
- As a user, I want to be able to view my history of results linked to my account.
- As a user, I want to be able to view a progress bar to know upload status of media to application.
- As a user, I want to be able to upload a batch of multiple medias.
- As a user, upon uploading media, I want the system to automatically extract its metadata.
- As a user, I want my uploaded media to be classified as AI generated or not and authentic/edited.
- As a user, I want the system to automatically extract metadata from my uploaded media.
- As a user, I want to be able to view easily my media classification results for each individual media.
- As a user, upon viewing media results, I want to be able to view both AI generated or not and authentic/edited in one view.
- As a user, I want the system to generate a Grad CAM heatmap after classifying the media uploaded.
- As a user, I want the Grad CAM results to be viewable in my history.
- As a user, I want to see my results in a history tab for future use and analysis.

### NEW USER STORIES:
- As a user, I want to export analysis results as PDF, CSV, or DOCX.
- As a user, I want the dates in project settings to be displayed as day/month/year format.
- As a user, I want to be able to see a progress bar while algorithms are running in the background.
- As a user, I want the system to provide a summary like results, so that findings are easily interpreted.
- As a user, I want each result of each individual media to be reported individually.
- As a user, I want to be able to select which models (traditional or deep learning) to run from a selection bar, so that I have a choice in which techniques is used.
- As a user, I want the system to perform file header analysis, so that I can detect potential anomalies in file structure.
- As a user, I want anomaly detection sentences (e.g., "Anomalies detected" / "No anomalies found"), so that I understand the outcome instead of just raw data.
- As a user, I want additional traditional methods to be implemented, so that I can access a wider range of analysis techniques.
- As a user, I want to see separate confidence scores for each method, so that I can evaluate results individually.
- As a user, I want to choose which traditional methods to run, so that I don't waste time on unnecessary algorithms.
- As a user, I want to choose which neural network models to run, so that I can tailor the analysis to my needs.

## Admin Stories
- As an admin, I want to see confidence levels of media uploads from users so I can continuously update and train the model.
- As an admin, I want to be able to see user history (given permission) to be able to find edge cases and further improve the system.

## Product Backlog

| Title | User Story | Priority |
|---|---|---|
| Upload images/videos | As a user, I want to upload media to get it classified as real/fake. | High |
| Log in with history | As a user, I want to log into a system that has a history of uploads and results in a secure manner linked to my account. | Medium |
| Extract metadata from media | As a user, I want the system to automatically extract metadata from my uploaded media so that I can see if an image is edited or not. | High |
| Classify edited or not | As a user, I want the system to automatically extract metadata from my uploaded media so that I can see if an image is edited or not. | High |
| Generate Grad CAM heatmap | As a user, I want the system to generate a Grad CAM heatmap, so I am able to see which parts of my uploaded media have been classified as real/fake. | Medium |
| Classify real/fake and edited/authentic | As a user, I want the system to combine results from classification and metadata so that I have a final answer of real/fake and edited/authentic. | High |
| Review past uploads | As a user, I want to see my results in a history tab for future use and analysis. | Low |
| Continuously train low confidence classification | As an admin, I want to see confidence levels of media uploads from users so I can continuously update and train the model. | Low |
| Improve model upon edge cases | As an admin, I want to be able to see user history (given permission) to be able to find edge cases and further improve the system. | Low |

### Additional Product Backlog

| Title | User Story | Priority |
|---|---|---|
| Export results | As a user, I want to export analysis results as PDF, CSV, or DOCX. | High |
| Date format settings | As a user, I want the dates in project settings to be displayed as day/month/year format. | Low |
| Progress bar | As a user, I want to be able to see a progress bar while algorithms are running in the background. | High |
| Summarized results | As a user, I want the system to provide a summary-like result, so that findings are easily interpreted. | Medium |
| Independent results per media | As a user, I want each result of each individual media to be reported individually. | High |
| Model selection | As a user, I want to be able to select which models (traditional or deep learning) to run from a selection bar, so that I have a choice in which techniques are used. | High |
| File header analysis | As a user, I want the system to perform file header analysis, so that I can detect potential anomalies in file structure. | Medium |
| Anomaly detection sentences | As a user, I want anomaly detection sentences (e.g., "Anomalies detected" / "No anomalies found"), so that I understand the outcome instead of just raw data. | Low |
| Additional traditional methods | As a user, I want additional traditional methods to be implemented, so that I can access a wider range of analysis techniques. | Medium |
| Separate confidence scores | As a user, I want to see separate confidence scores for each method, so that I can evaluate results individually. | Medium |
| Traditional method selection | As a user, I want to choose which traditional methods to run, so that I don't waste time on unnecessary algorithms. | Medium |
| Neural network model selection | As a user, I want to choose which neural network models to run, so that I can tailor the analysis to my needs. | Medium |

---

# Motivational Model

motivational model(1).pdf  
05 9 2025, 07:00 下午